"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[1502],{55484:(e,t,n)=>{n.d(t,{Z:()=>X});var r,o=n(67294),s=n(24011),i=n(14890),a=n(63274),l=n(61366),c=n(5934),u=n(77297),d=n(74008),p=n(81034),g=n(11157),y=n(52835),h=n(39905),f=n(75708),E=n(98049),D=n(65914),S=n(51405),m=n(44187),v=n(170),C=n(94898),w=n(36146),T=n(54820),M=n(31300),R=n(61284),F=n(36808),L=n(26651),P=n(19412),b=n(54767),B=n(94315),x=n(310),A=n(19990),k=n(4137),G=n(94968),N=n(36374),O=n(65186);function Z(e){return B.T&&e&&e.perspectiveSettings&&e.perspectiveSettings[k.TU.GRID]?e.perspectiveSettings[k.TU.GRID]:JSON.parse(localStorage.getItem(A.defaultSettings.settingsKey))}function H(e){const t=B.T&&e.directoryMeta&&e.directoryMeta.perspectiveSettings&&e.directoryMeta.perspectiveSettings[k.TU.GRID],n=Z(e.directoryMeta),[r,s]=(0,o.useState)(void 0),[i,l]=(0,o.useState)(void 0),d=(0,o.useRef)(void 0),p=(0,o.useRef)(null),[S,m]=(0,o.useState)(null),[v,R]=(0,o.useState)(null),[H,I]=(0,o.useState)(null),[z,U]=(0,o.useState)(null),[X,Y]=(0,o.useState)(null),[K,J]=(0,o.useState)(void 0),j=(0,o.useRef)(n&&n.sortBy?n.sortBy:A.defaultSettings.sortBy),W=(0,o.useRef)(n&&void 0!==n.orderBy?n.orderBy:A.defaultSettings.orderBy),$=(0,o.useRef)(e.searchResultsCount<0?e.directoryContent:N.Z.results),q=(0,o.useRef)(n&&n.layoutType?n.layoutType:A.defaultSettings.layoutType),Q=(0,o.useRef)(n&&n.singleClickAction?n.singleClickAction:A.defaultSettings.singleClickAction),V=(0,o.useRef)(n&&n.entrySize?n.entrySize:A.defaultSettings.entrySize),_=(0,o.useRef)(n&&n.thumbnailMode?n.thumbnailMode:A.defaultSettings.thumbnailMode),ee=(0,o.useRef)(n&&void 0!==n.showDirectories?n.showDirectories:A.defaultSettings.showDirectories),te=(0,o.useRef)(n&&void 0!==n.showDetails?n.showDetails:A.defaultSettings.showDetails),ne=(0,o.useRef)(n&&void 0!==n.showDescription?n.showDescription:A.defaultSettings.showDescription),re=(0,o.useRef)(n&&void 0!==n.showEntriesDescription?n.showEntriesDescription:A.defaultSettings.showEntriesDescription),oe=(0,o.useRef)(n&&void 0!==n.showTags?n.showTags:A.defaultSettings.showTags),[se,ie]=(0,o.useState)(!1),[ae,le]=(0,o.useState)(!1),[ce,ue]=(0,o.useState)(!1),de=(0,o.useRef)(n&&n.gridPageLimit?n.gridPageLimit:A.defaultSettings.gridPageLimit),pe=(0,o.useRef)(void 0),[ge,ye]=(0,o.useReducer)((e=>e+1),0),he=(0,O.Z)(),{classes:fe,selectedEntries:Ee,loadParentDirectoryContent:De,theme:Se,currentDirectoryPath:me}=e;(0,o.useEffect)((()=>{1===e.selectedEntries.length&&ve()}),[e.selectedEntries]),(0,o.useEffect)((()=>{he||($.current=(0,c.sortByCriteria)(e.searchFilter?e.directoryContent.filter((t=>t.name.toLowerCase().includes(e.searchFilter.toLowerCase()))):e.directoryContent,j.current,W.current),ye())}),[e.searchFilter]),(0,o.useEffect)((()=>{he||(e.searchResultsCount<0?$.current=(0,c.sortByCriteria)(e.directoryContent,j.current,W.current):"byName"===j.current?$.current=N.Z.results:$.current=(0,c.sortByCriteria)(e.searchFilter?N.Z.results.filter((t=>t.name.toLowerCase().includes(e.searchFilter.toLowerCase()))):N.Z.results,j.current,W.current),ye())}),[e.directoryContent,e.searchResultsCount,j.current,W.current]),(0,o.useEffect)((()=>{!he&&e.searchResultsCount>-1&&($.current=N.Z.results,ye())}),[e.editedEntryPaths]),(0,o.useEffect)((()=>{if(!he){const t=Z(e.directoryMeta);ee.current=t&&void 0!==t.showDirectories?t.showDirectories:A.defaultSettings.showDirectories,ne.current=t&&void 0!==t.showDescription?t.showDescription:A.defaultSettings.showDescription,re.current=t&&void 0!==t.showEntriesDescription?t.showEntriesDescription:A.defaultSettings.showEntriesDescription,te.current=t&&void 0!==t.showDetails?t.showDetails:A.defaultSettings.showDetails,oe.current=t&&void 0!==t.showTags?t.showTags:A.defaultSettings.showTags,q.current=A.defaultSettings.layoutType,W.current=t&&void 0!==t.orderBy?t.orderBy:A.defaultSettings.orderBy,j.current=t&&void 0!==t.sortBy?t.sortBy:A.defaultSettings.sortBy,Q.current=t&&void 0!==t.singleClickAction?t.singleClickAction:A.defaultSettings.singleClickAction,V.current=t&&void 0!==t.entrySize?t.entrySize:A.defaultSettings.entrySize,_.current=t&&void 0!==t.thumbnailMode?t.thumbnailMode:A.defaultSettings.thumbnailMode,de.current=t&&void 0!==t.gridPageLimit?t.gridPageLimit:A.defaultSettings.gridPageLimit,ye()}}),[e.directoryMeta]),(0,o.useEffect)((()=>{if(!he&&void 0!==pe.current){const t={showDirectories:ee.current,showDescription:ne.current,showEntriesDescription:re.current,showDetails:te.current,showTags:oe.current,layoutType:q.current,orderBy:W.current,sortBy:j.current,singleClickAction:Q.current,entrySize:V.current,thumbnailMode:_.current,gridPageLimit:de.current};B.T&&!pe.current?B.T.MetaOperations.savePerspectiveSettings(me,k.TU.GRID,t).then((t=>{e.setDirectoryMeta(t)})):(localStorage.setItem(A.defaultSettings.settingsKey,JSON.stringify(t)),ye()),pe.current=void 0}}),[pe.current,ee.current,ne.current,re.current,te.current,oe.current,q.current,W.current,j.current,Q.current,V.current,_.current,de.current]);const ve=()=>{if(Ee&&Ee.length>0){const e=document.querySelector('[data-entry-id="'+Ee[0].uuid+'"]');(0,c.isObj)(e)&&!(0,u.ex)(e)&&e.scrollIntoView(!1)}},Ce=e=>{const t=e?e.currentTarget:null;U(t)},we=()=>{e.setSelectedEntries([]),d.current=void 0},Te=Ee.length>1,Me=()=>{Te?we():e.searchResultsCount<0?e.setSelectedEntries(e.directoryContent):e.setSelectedEntries(N.Z.results)},Re=()=>{ke(),ee.current=!ee.current},Fe=()=>{ke(),oe.current=!oe.current},Le=()=>{ke();const e="cover"===_.current?"contain":"cover";return _.current=e,e},Pe=e=>{ke(),V.current=e},be=e=>{ke(),Q.current=e},Be=()=>{ke(),e.openURLExternally(x.Z.documentationLinks.defaultPerspective)},xe=()=>{ke(),ue(!0)},Ae=(e,t,n)=>{e.preventDefault(),e.stopPropagation(),p.current=t,d.current=n,I(e.currentTarget)},ke=()=>{Y(null)},Ge=()=>{ie(!0)},Ne=()=>{e.toggleDeleteMultipleEntriesDialog()},Oe=()=>{le(!0)},Ze={nextDocument:e.keyBindings.nextDocument,prevDocument:e.keyBindings.prevDocument,selectAll:e.keyBindings.selectAll,deleteDocument:e.keyBindings.deleteDocument,addRemoveTags:e.keyBindings.addRemoveTags,renameFile:e.keyBindings.renameFile,openEntry:e.keyBindings.openEntry,openFileExternally:e.keyBindings.openFileExternally},He={nextDocument:()=>e.openNextFile(),prevDocument:()=>e.openPrevFile(),selectAll:()=>Me(),deleteDocument:()=>{(0,G.eB)(e.selectedEntries)&&Ne()},addRemoveTags:()=>{e.lastSelectedEntryPath&&Oe()},renameFile:()=>{e.openRenameEntryDialog()},openEntry:t=>{t.preventDefault(),e.openFsEntry()},openFileExternally:()=>{e.openFileNatively()}},Ie=Ee?Ee.filter((e=>e.isFile)).map((e=>e.path)):[],ze=$.current.filter((e=>!e.isFile)),Ue=$.current.filter((e=>e.isFile)),Xe=e.currentLocation?F.Z.getLocationPath(e.currentLocation):"";let Ye=200;return"small"===V.current?Ye=150:"normal"===V.current?Ye=200:"big"===V.current&&(Ye=300),o.createElement("div",{style:{height:"calc(100% - 48px)"},"data-tid":A.defaultSettings.testID},o.createElement(w.Z,{classes:fe,layoutType:q.current,isReadOnlyMode:e.isReadOnlyMode,selectedEntries:Ee,loadParentDirectoryContent:De,toggleSelectAllFiles:Me,someFileSelected:Te,handleLayoutSwitch:e=>{q.current=e},openAddRemoveTagsDialog:Oe,fileOperationsEnabled:(0,G.eB)(e.selectedEntries),openMoveCopyFilesDialog:Ge,openDeleteFileDialog:Ne,openFsEntry:e.openFsEntry,handleSortingMenu:Ce,handleExportCsvMenu:()=>{B.T&&B.T.exportAsCsv.ExportAsCsv(e.directoryContent)},openSettings:xe,directoryPath:me}),o.createElement(a.GlobalHotKeys,{keyMap:Ze,handlers:He,allowChanges:!0},o.createElement(L.Z,{gridPageLimit:de.current,style:{margin:0,display:"grid",gridGap:"5px 5px",padding:5,paddingBottom:10,gridTemplateColumns:"repeat(auto-fit,minmax("+Ye+"px,1fr))"},classes:fe,theme:Se,directories:ze,showDetails:te.current,showDescription:ne.current,showDirectories:ee.current,isReadOnlyMode:e.isReadOnlyMode,layoutType:q.current,desktopMode:e.desktopMode,openRenameEntryDialog:e.openRenameEntryDialog,showTags:oe.current,thumbnailMode:_.current,entrySize:V.current,files:Ue,getCellContent:(t,n,r,i,a,c,u)=>{let d=!1;return n&&n.some((e=>e.path===t.path))&&(d=!0),o.createElement(D.Z,{entryPath:t.path,selectedEntries:n.length>0?n:[t]},o.createElement(C.Z,{selected:d,fsEntry:t,showEntriesDescription:re.current,entrySize:V.current,classes:fe,isLast:u,theme:Se,supportedFileTypes:e.supportedFileTypes,thumbnailMode:_.current,addTags:e.addTags,addTag:e.addTag,selectedEntries:n,selectEntry:t=>{e.setSelectedEntries([...n,t])},deselectEntry:t=>{const r=n.filter((e=>e.path!==t.path));e.setSelectedEntries(r)},isReadOnlyMode:e.isReadOnlyMode,handleTagMenu:Ae,layoutType:q.current,showTags:oe.current,openFsEntry:e.openFsEntry,handleGridContextMenu:(e,t)=>{s(e.clientX),l(e.clientY),i(e,t)},handleGridCellDblClick:c,handleGridCellClick:a}))},currentPage:1,currentLocationPath:Xe,currentDirectoryPath:e.currentDirectoryPath,onClick:t=>{t.preventDefault(),e.selectedEntries.length>0&&e.setSelectedEntries([])},onContextMenu:t=>{t.preventDefault(),s(t.clientX),l(t.clientY),e.selectedEntries.length>0&&e.setSelectedEntries([]),R(t.currentTarget)},settings:n,selectedEntries:e.selectedEntries,setSelectedEntries:e.setSelectedEntries,singleClickAction:Q.current,currentLocation:e.currentLocation,directoryContent:e.directoryContent,searchResultsCount:e.searchResultsCount,supportedFileTypes:e.supportedFileTypes,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,setFileContextMenuAnchorEl:m,setDirContextMenuAnchorEl:R,showNotification:e.showNotification,moveFiles:e.moveFiles,clearSelection:we})),ae&&o.createElement(f.Z,{open:ae,onClose:()=>le(!1),addTags:e.addTags,removeTags:e.removeTags,removeAllTags:e.removeAllTags,selectedEntries:e.selectedEntries}),void 0!==K&&o.createElement(b.Z,{open:!0,onClose:()=>J(void 0),addTag:e.addTag,selectedTag:K}),ce&&o.createElement(P.Z,{open:ce,onClose:e=>{ue(!1),pe.current=e},setGridPageLimit:e=>{de.current=e},gridPageLimit:de.current,toggleShowDirectories:Re,toggleShowTags:Fe,toggleShowDetails:()=>{ke(),te.current=!te.current},toggleShowDescription:()=>{ke(),ne.current=!ne.current},toggleShowEntriesDescription:()=>{ke(),re.current=!re.current},showDetails:te.current,showDescription:ne.current,showEntriesDescription:re.current,showDirectories:ee.current,showTags:oe.current,toggleThumbnailsMode:Le,thumbnailMode:_.current,changeEntrySize:Pe,entrySize:V.current,changeSingleClickAction:be,singleClickAction:Q.current,openHelpWebPage:Be,sortBy:j.current,orderBy:W.current,handleSortingMenu:Ce,isLocal:t,resetLocalSettings:()=>{B.T.MetaOperations.savePerspectiveSettings(me,k.TU.GRID).then((t=>{e.setDirectoryMeta(t),ue(!1)}))}}),se&&o.createElement(E.Z,{open:se,onClose:()=>ie(!1),selectedFiles:Ie}),Boolean(S)&&o.createElement(g.Z,{anchorEl:S,mouseX:r,mouseY:i,open:Boolean(S),onClose:()=>m(null),openDeleteFileDialog:Ne,openRenameFileDialog:e.openRenameEntryDialog,openMoveCopyFilesDialog:Ge,openAddRemoveTagsDialog:Oe,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,showInFileManager:e.showInFileManager,showNotification:e.showNotification,isReadOnlyMode:e.isReadOnlyMode,selectedFilePath:e.lastSelectedEntryPath,selectedEntries:e.selectedEntries,currentLocation:e.currentLocation,locations:e.locations}),o.createElement(y.Z,{open:Boolean(v),onClose:()=>R(null),anchorEl:v,mouseX:r,mouseY:i,directoryPath:e.lastSelectedEntryPath,loadDirectoryContent:e.loadDirectoryContent,openRenameDirectoryDialog:e.openRenameEntryDialog,openDirectory:e.openDirectory,openFsEntry:e.openFsEntry,perspectiveMode:e.lastSelectedEntryPath!==e.currentDirectoryPath,currentLocation:e.currentLocation,locations:e.locations}),o.createElement(h.Z,{anchorEl:H,open:Boolean(H),onClose:()=>I(null),setIsAddTagDialogOpened:J,selectedTag:p.current,currentEntryPath:d.current,removeTags:e.removeTags,isReadOnlyMode:e.isReadOnlyMode}),Boolean(z)&&o.createElement(T.Z,{open:Boolean(z),onClose:()=>U(null),anchorEl:z,sortBy:j.current,orderBy:W.current,handleSortBy:e=>{j.current!==e?j.current=e:W.current=!W.current,U(null)}}),Boolean(X)&&o.createElement(M.Z,{open:Boolean(X),onClose:ke,anchorEl:X,toggleShowDirectories:Re,showDirectories:ee.current,toggleShowTags:Fe,showTags:oe.current,toggleThumbnailsMode:Le,thumbnailMode:_.current,entrySize:V.current,changeSingleClickAction:be,singleClickAction:Q.current,changeEntrySize:Pe,openHelpWebPage:Be,openSettings:xe}))}function I(e){return(0,i.DE)({moveFiles:S.Z.moveFiles,setSelectedEntries:m.Nw.setSelectedEntries,showNotification:m.Nw.showNotification,openFileNatively:m.Nw.openFileNatively,openURLExternally:m.Nw.openURLExternally,openNextFile:m.Nw.openNextFile,openPrevFile:m.Nw.openPrevFile,setDirectoryMeta:m.Nw.setDirectoryMeta,toggleDeleteMultipleEntriesDialog:m.Nw.toggleDeleteMultipleEntriesDialog,addTags:v.Z.addTags,addTag:m.Nw.addTag},e)}function z(e){return{directoryMeta:(0,m.ah)(e),supportedFileTypes:(0,d.M3)(e),isReadOnlyMode:(0,m.vo)(e),lastSelectedEntry:(0,m.ww)(e),desktopMode:(0,d.HK)(e),selectedEntries:(0,m.lv)(e),lastSelectedEntryPath:(0,m.Fv)(e),keyBindings:(0,d.PP)(e),currentLocation:(0,R.k$)(e,e.app.currentLocationId),locations:(0,R.JC)(e),isDeleteMultipleEntriesDialogOpened:(0,m.HT)(e),searchFilter:(0,m.QT)(e),editedEntryPaths:(0,m.OB)(e)}}e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(H,"useState{[mouseX, setMouseX](undefined)}\nuseState{[mouseY, setMouseY](undefined)}\nuseRef{selectedEntryPath}\nuseRef{selectedTag}\nuseState{[fileContextMenuAnchorEl, setFileContextMenuAnchorEl](null)}\nuseState{[dirContextMenuAnchorEl, setDirContextMenuAnchorEl](null)}\nuseState{[tagContextMenuAnchorEl, setTagContextMenuAnchorEl](null)}\nuseState{[sortingContextMenuAnchorEl, setSortingContextMenuAnchorEl](null)}\nuseState{[optionsContextMenuAnchorEl, setOptionsContextMenuAnchorEl](null)}\nuseState{[isAddTagDialogOpened, setIsAddTagDialogOpened](undefined)}\nuseRef{sortBy}\nuseRef{orderBy}\nuseRef{sortedDirContent}\nuseRef{layoutType}\nuseRef{singleClickAction}\nuseRef{entrySize}\nuseRef{thumbnailMode}\nuseRef{showDirectories}\nuseRef{showDetails}\nuseRef{showDescription}\nuseRef{showEntriesDescription}\nuseRef{showTags}\nuseState{[isMoveCopyFilesDialogOpened, setIsMoveCopyFilesDialogOpened](false)}\nuseState{[isAddRemoveTagsDialogOpened, setIsAddRemoveTagsDialogOpened](false)}\nuseState{[isGridSettingsDialogOpened, setIsGridSettingsDialogOpened](false)}\nuseRef{gridPageLimit}\nuseRef{isDefaultSetting}\nuseReducer{[ignored, forceUpdate](0)}\nuseFirstRender{firstRender}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}",(()=>[O.Z]));const U=(0,s.$j)(z,I)((0,l.Z)(p.Z,{withTheme:!0})(H)),X=U;var Y,K;(Y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(Y.register(Z,"getSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),Y.register(H,"GridPerspective","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),Y.register(I,"mapActionCreatorsToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),Y.register(z,"mapStateToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx"),Y.register(U,"default","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/components/MainContainer.tsx")),(K="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&K(e)},19990:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o.Z,defaultSettings:()=>s});var r,o=n(55484);e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const s={testID:"gridPerspectiveContainer",settingsKey:"tsPerspectiveGrid",orderBy:!0,sortBy:"byName",layoutType:"grid",singleClickAction:"openInternal",entrySize:"small",thumbnailMode:"contain",showDirectories:!0,showDetails:!0,showDescription:!1,showEntriesDescription:!0,showTags:!0,gridPageLimit:100};var i,a;(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&i.register(s,"defaultSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/grid-perspective/index.tsx"),(a="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&a(e)}}]);
//# sourceMappingURL=1502.bundle.js.map