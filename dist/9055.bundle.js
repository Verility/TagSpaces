"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[9055],{13899:(e,t,n)=>{n.d(t,{Z:()=>X});var r,o=n(67294),s=n(24011),i=n(14890),l=n(63274),a=n(61366),c=n(5934),u=n(77297),d=n(74008),g=n(81034),p=n(11157),y=n(52835),h=n(39905),f=n(75708),S=n(98049),E=n(65914),D=n(51405),m=n(44187),v=n(170),T=n(94898),w=n(36146),M=n(54820),C=n(31300),R=n(61284),F=n(36808),L=n(26651),b=n(19412),P=n(54767),B=n(94315),A=n(310),x=n(99765),k=n(4137),O=n(94968),N=n(36374),G=n(65186);function Z(e){return B.T&&e&&e.perspectiveSettings&&e.perspectiveSettings[k.TU.LIST]?e.perspectiveSettings[k.TU.LIST]:JSON.parse(localStorage.getItem(x.defaultSettings.settingsKey))}function H(e){const t=B.T&&e.directoryMeta&&e.directoryMeta.perspectiveSettings&&e.directoryMeta.perspectiveSettings[k.TU.LIST],n=Z(e.directoryMeta),[r,s]=(0,o.useState)(void 0),[i,a]=(0,o.useState)(void 0),d=(0,o.useRef)(void 0),g=(0,o.useRef)(null),[D,m]=(0,o.useState)(null),[v,R]=(0,o.useState)(null),[H,I]=(0,o.useState)(null),[z,U]=(0,o.useState)(null),[X,Y]=(0,o.useState)(null),[K,J]=(0,o.useState)(void 0),j=(0,o.useRef)(n&&n.sortBy?n.sortBy:x.defaultSettings.sortBy),W=(0,o.useRef)(n&&void 0!==n.orderBy?n.orderBy:x.defaultSettings.orderBy),$=(0,o.useRef)(n&&n.layoutType?n.layoutType:x.defaultSettings.layoutType),q=(0,o.useRef)(n&&n.singleClickAction?n.singleClickAction:x.defaultSettings.singleClickAction),V=(0,o.useRef)(n&&n.entrySize?n.entrySize:x.defaultSettings.entrySize),Q=(0,o.useRef)(n&&n.thumbnailMode?n.thumbnailMode:x.defaultSettings.thumbnailMode),_=(0,o.useRef)(n&&void 0!==n.showDirectories?n.showDirectories:x.defaultSettings.showDirectories),ee=(0,o.useRef)(n&&void 0!==n.showDetails?n.showDetails:x.defaultSettings.showDetails),te=(0,o.useRef)(n&&void 0!==n.showDescription?n.showDescription:x.defaultSettings.showDescription),ne=(0,o.useRef)(n&&void 0!==n.showEntriesDescription?n.showEntriesDescription:x.defaultSettings.showEntriesDescription),re=(0,o.useRef)(n&&void 0!==n.showTags?n.showTags:x.defaultSettings.showTags),[oe,se]=(0,o.useState)(!1),[ie,le]=(0,o.useState)(!1),[ae,ce]=(0,o.useState)(!1),ue=(0,o.useRef)(n&&n.gridPageLimit?n.gridPageLimit:x.defaultSettings.gridPageLimit),de=(0,o.useRef)(void 0),[ge,pe]=(0,o.useReducer)((e=>e+1),0),ye=(0,G.Z)();(0,o.useEffect)((()=>{1===e.selectedEntries.length&&fe()}),[e.selectedEntries]),(0,o.useEffect)((()=>{!ye&&e.searchResultsCount>-1&&pe()}),[e.editedEntryPaths]),(0,o.useEffect)((()=>{if(!ye){const t=Z(e.directoryMeta);_.current=t&&void 0!==t.showDirectories?t.showDirectories:x.defaultSettings.showDirectories,te.current=t&&void 0!==t.showDescription?t.showDescription:x.defaultSettings.showDescription,ne.current=t&&void 0!==t.showEntriesDescription?t.showEntriesDescription:x.defaultSettings.showEntriesDescription,ee.current=t&&void 0!==t.showDetails?t.showDetails:x.defaultSettings.showDetails,re.current=t&&void 0!==t.showTags?t.showTags:x.defaultSettings.showTags,$.current=x.defaultSettings.layoutType,W.current=t&&void 0!==t.orderBy?t.orderBy:x.defaultSettings.orderBy,j.current=t&&void 0!==t.sortBy?t.sortBy:x.defaultSettings.sortBy,q.current=t&&void 0!==t.singleClickAction?t.singleClickAction:x.defaultSettings.singleClickAction,V.current=t&&void 0!==t.entrySize?t.entrySize:x.defaultSettings.entrySize,Q.current=t&&void 0!==t.thumbnailMode?t.thumbnailMode:x.defaultSettings.thumbnailMode,ue.current=t&&void 0!==t.gridPageLimit?t.gridPageLimit:x.defaultSettings.gridPageLimit,pe()}}),[e.directoryMeta]),(0,o.useEffect)((()=>{if(!ye&&void 0!==de.current){const t={showDirectories:_.current,showDescription:te.current,showEntriesDescription:ne.current,showDetails:ee.current,showTags:re.current,layoutType:$.current,orderBy:W.current,sortBy:j.current,singleClickAction:q.current,entrySize:V.current,thumbnailMode:Q.current,gridPageLimit:ue.current};B.T&&!de.current?B.T.MetaOperations.savePerspectiveSettings(we,k.TU.LIST,t).then((t=>{e.setDirectoryMeta(t)})):(localStorage.setItem(x.defaultSettings.settingsKey,JSON.stringify(t)),pe()),de.current=void 0}}),[de.current,_.current,te.current,ne.current,ee.current,re.current,$.current,W.current,j.current,q.current,V.current,Q.current,ue.current]);const he=(0,o.useMemo)((()=>(0,c.sortByCriteria)(e.directoryContent,j.current,W.current)),[e.directoryContent,j.current,W.current]),fe=()=>{const{selectedEntries:t}=e;if(t&&t.length>0){const e=document.querySelector('[data-entry-id="'+t[0].uuid+'"]');(0,c.isObj)(e)&&!(0,u.ex)(e)&&e.scrollIntoView(!1)}},Se=e=>{const t=e?e.currentTarget:null;U(t)},Ee=()=>{e.setSelectedEntries([]),d.current=void 0},{classes:De,selectedEntries:me,loadParentDirectoryContent:ve,theme:Te,currentDirectoryPath:we}=e,Me=me.length>1,Ce=()=>{Me?Ee():e.setSelectedEntries(e.directoryContent)},Re=()=>{ke(),_.current=!_.current},Fe=()=>{ke(),re.current=!re.current},Le=()=>{ke();const e="cover"===Q.current?"contain":"cover";return Q.current=e,e},be=e=>{ke(),V.current=e},Pe=e=>{ke(),q.current=e},Be=()=>{ke(),e.openURLExternally(A.Z.documentationLinks.defaultPerspective)},Ae=()=>{ke(),ce(!0)},xe=(e,t,n)=>{e.preventDefault(),e.stopPropagation(),g.current=t,d.current=n,I(e.currentTarget)},ke=()=>{Y(null)},Oe=()=>{se(!0)},Ne=()=>{e.toggleDeleteMultipleEntriesDialog()},Ge=()=>{le(!0)},Ze={nextDocument:e.keyBindings.nextDocument,prevDocument:e.keyBindings.prevDocument,selectAll:e.keyBindings.selectAll,deleteDocument:e.keyBindings.deleteDocument,addRemoveTags:e.keyBindings.addRemoveTags,renameFile:e.keyBindings.renameFile,openEntry:e.keyBindings.openEntry,openFileExternally:e.keyBindings.openFileExternally},He=()=>e.lastSelectedEntry?e.lastSelectedEntry.path:we,Ie={nextDocument:()=>e.openNextFile(),prevDocument:()=>e.openPrevFile(),selectAll:()=>Ce(),deleteDocument:()=>{(0,O.eB)(e.selectedEntries)&&Ne()},addRemoveTags:()=>{He()&&Ge()},renameFile:()=>{e.openRenameEntryDialog()},openEntry:t=>{t.preventDefault(),e.openFsEntry()},openFileExternally:()=>{e.openFileNatively()}},ze=me?me.filter((e=>e.isFile)).map((e=>e.path)):[],Ue=e.searchResultsCount<0?he.filter((e=>!e.isFile)):[],Xe=e.searchResultsCount<0?he.filter((e=>e.isFile)):N.Z.results,Ye=e.currentLocation?F.Z.getLocationPath(e.currentLocation):"";let Ke=200;return"small"===V.current?Ke=150:"normal"===V.current?Ke=200:"big"===V.current&&(Ke=300),o.createElement("div",{style:{height:"calc(100% - 48px)"},"data-tid":x.defaultSettings.testID},o.createElement(w.Z,{classes:De,layoutType:$.current,isReadOnlyMode:e.isReadOnlyMode,selectedEntries:me,loadParentDirectoryContent:ve,toggleSelectAllFiles:Ce,someFileSelected:Me,handleLayoutSwitch:e=>{$.current=e},openAddRemoveTagsDialog:Ge,fileOperationsEnabled:(0,O.eB)(e.selectedEntries),openMoveCopyFilesDialog:Oe,openDeleteFileDialog:Ne,openFsEntry:e.openFsEntry,handleSortingMenu:Se,handleExportCsvMenu:()=>{B.T&&B.T.exportAsCsv.ExportAsCsv(e.directoryContent)},openSettings:Ae,directoryPath:we}),o.createElement(l.GlobalHotKeys,{keyMap:Ze,handlers:Ie,allowChanges:!0},o.createElement(L.Z,{gridPageLimit:ue.current,style:{marginTop:5,paddingRight:4,paddingLeft:4,gridTemplateColumns:"none"},classes:De,theme:Te,directories:Ue,showDetails:ee.current,showDescription:te.current,showDirectories:_.current,isReadOnlyMode:e.isReadOnlyMode,layoutType:$.current,desktopMode:e.desktopMode,openRenameEntryDialog:e.openRenameEntryDialog,showTags:re.current,thumbnailMode:Q.current,entrySize:V.current,files:Xe,getCellContent:(t,n,r,i,l,c,u)=>{let d=!1;return n&&n.some((e=>e.path===t.path))&&(d=!0),o.createElement(E.Z,{entryPath:t.path,selectedEntries:n.length>0?n:[t]},o.createElement(T.Z,{selected:d,fsEntry:t,showEntriesDescription:ne.current,entrySize:V.current,classes:De,isLast:u,theme:Te,supportedFileTypes:e.supportedFileTypes,thumbnailMode:Q.current,addTags:e.addTags,addTag:e.addTag,selectedEntries:n,selectEntry:t=>{e.setSelectedEntries([...n,t])},deselectEntry:t=>{const r=n.filter((e=>e.path!==t.path));e.setSelectedEntries(r)},isReadOnlyMode:e.isReadOnlyMode,handleTagMenu:xe,layoutType:$.current,showTags:re.current,openFsEntry:e.openFsEntry,handleGridContextMenu:(e,t)=>{s(e.clientX),a(e.clientY),i(e,t)},handleGridCellDblClick:c,handleGridCellClick:l}))},currentPage:1,currentLocationPath:Ye,currentDirectoryPath:e.currentDirectoryPath,onClick:t=>{t.preventDefault(),e.selectedEntries.length>0&&e.setSelectedEntries([])},onContextMenu:t=>{t.preventDefault(),s(t.clientX),a(t.clientY),e.selectedEntries.length>0&&e.setSelectedEntries([]),R(t.currentTarget)},settings:n,selectedEntries:e.selectedEntries,setSelectedEntries:e.setSelectedEntries,singleClickAction:q.current,currentLocation:e.currentLocation,directoryContent:e.directoryContent,searchResultsCount:e.searchResultsCount,supportedFileTypes:e.supportedFileTypes,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,setFileContextMenuAnchorEl:m,setDirContextMenuAnchorEl:R,showNotification:e.showNotification,moveFiles:e.moveFiles,clearSelection:Ee})),ie&&o.createElement(f.Z,{open:ie,onClose:()=>le(!1),addTags:e.addTags,removeTags:e.removeTags,removeAllTags:e.removeAllTags,selectedEntries:e.selectedEntries}),void 0!==K&&o.createElement(P.Z,{open:!0,onClose:()=>J(void 0),addTag:e.addTag,selectedTag:K}),ae&&o.createElement(b.Z,{open:ae,onClose:e=>{ce(!1),de.current=e},setGridPageLimit:e=>{ue.current=e},gridPageLimit:ue.current,toggleShowDirectories:Re,toggleShowTags:Fe,toggleShowDetails:()=>{ke(),ee.current=!ee.current},toggleShowDescription:()=>{ke(),te.current=!te.current},toggleShowEntriesDescription:()=>{ke(),ne.current=!ne.current},showDetails:ee.current,showDescription:te.current,showEntriesDescription:ne.current,showDirectories:_.current,showTags:re.current,toggleThumbnailsMode:Le,thumbnailMode:Q.current,changeEntrySize:be,entrySize:V.current,changeSingleClickAction:Pe,singleClickAction:q.current,openHelpWebPage:Be,sortBy:j.current,orderBy:W.current,handleSortingMenu:Se,isLocal:t,resetLocalSettings:()=>{B.T.MetaOperations.savePerspectiveSettings(we,k.TU.LIST).then((t=>{e.setDirectoryMeta(t),ce(!1)}))}}),oe&&o.createElement(S.Z,{open:oe,onClose:()=>se(!1),selectedFiles:ze}),Boolean(D)&&o.createElement(p.Z,{anchorEl:D,mouseX:r,mouseY:i,open:Boolean(D),onClose:()=>m(null),openDeleteFileDialog:Ne,openRenameFileDialog:e.openRenameEntryDialog,openMoveCopyFilesDialog:Oe,openAddRemoveTagsDialog:Ge,openFsEntry:e.openFsEntry,openFileNatively:e.openFileNatively,loadDirectoryContent:e.loadDirectoryContent,showInFileManager:e.showInFileManager,showNotification:e.showNotification,isReadOnlyMode:e.isReadOnlyMode,selectedFilePath:He(),selectedEntries:e.selectedEntries,currentLocation:e.currentLocation,locations:e.locations}),o.createElement(y.Z,{open:Boolean(v),onClose:()=>R(null),anchorEl:v,mouseX:r,mouseY:i,directoryPath:He(),loadDirectoryContent:e.loadDirectoryContent,openRenameDirectoryDialog:e.openRenameEntryDialog,openDirectory:e.openDirectory,openFsEntry:e.openFsEntry,perspectiveMode:He()!==e.currentDirectoryPath,currentLocation:e.currentLocation,locations:e.locations}),o.createElement(h.Z,{anchorEl:H,open:Boolean(H),onClose:()=>I(null),setIsAddTagDialogOpened:J,selectedTag:g.current,currentEntryPath:d.current,removeTags:e.removeTags,isReadOnlyMode:e.isReadOnlyMode}),Boolean(z)&&o.createElement(M.Z,{open:Boolean(z),onClose:()=>U(null),anchorEl:z,sortBy:j.current,orderBy:W.current,handleSortBy:e=>{j.current!==e?j.current=e:W.current=!W.current,U(null)}}),Boolean(X)&&o.createElement(C.Z,{open:Boolean(X),onClose:ke,anchorEl:X,toggleShowDirectories:Re,showDirectories:_.current,toggleShowTags:Fe,showTags:re.current,toggleThumbnailsMode:Le,thumbnailMode:Q.current,entrySize:V.current,changeSingleClickAction:Pe,singleClickAction:q.current,changeEntrySize:be,openHelpWebPage:Be,openSettings:Ae}))}function I(e){return(0,i.DE)({moveFiles:D.Z.moveFiles,setSelectedEntries:m.Nw.setSelectedEntries,showNotification:m.Nw.showNotification,openFileNatively:m.Nw.openFileNatively,openURLExternally:m.Nw.openURLExternally,openNextFile:m.Nw.openNextFile,openPrevFile:m.Nw.openPrevFile,setDirectoryMeta:m.Nw.setDirectoryMeta,toggleDeleteMultipleEntriesDialog:m.Nw.toggleDeleteMultipleEntriesDialog,addTags:v.Z.addTags,addTag:m.Nw.addTag},e)}function z(e){return{directoryMeta:(0,m.ah)(e),supportedFileTypes:(0,d.M3)(e),isReadOnlyMode:(0,m.vo)(e),lastSelectedEntry:(0,m.ww)(e),desktopMode:(0,d.HK)(e),selectedEntries:(0,m.lv)(e),keyBindings:(0,d.PP)(e),currentLocation:(0,R.k$)(e,e.app.currentLocationId),locations:(0,R.JC)(e),isDeleteMultipleEntriesDialogOpened:(0,m.HT)(e),editedEntryPaths:(0,m.OB)(e)}}e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),("undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default.signature:function(e){return e})(H,"useState{[mouseX, setMouseX](undefined)}\nuseState{[mouseY, setMouseY](undefined)}\nuseRef{selectedEntryPath}\nuseRef{selectedTag}\nuseState{[fileContextMenuAnchorEl, setFileContextMenuAnchorEl](null)}\nuseState{[dirContextMenuAnchorEl, setDirContextMenuAnchorEl](null)}\nuseState{[tagContextMenuAnchorEl, setTagContextMenuAnchorEl](null)}\nuseState{[sortingContextMenuAnchorEl, setSortingContextMenuAnchorEl](null)}\nuseState{[optionsContextMenuAnchorEl, setOptionsContextMenuAnchorEl](null)}\nuseState{[isAddTagDialogOpened, setIsAddTagDialogOpened](undefined)}\nuseRef{sortBy}\nuseRef{orderBy}\nuseRef{layoutType}\nuseRef{singleClickAction}\nuseRef{entrySize}\nuseRef{thumbnailMode}\nuseRef{showDirectories}\nuseRef{showDetails}\nuseRef{showDescription}\nuseRef{showEntriesDescription}\nuseRef{showTags}\nuseState{[isMoveCopyFilesDialogOpened, setIsMoveCopyFilesDialogOpened](false)}\nuseState{[isAddRemoveTagsDialogOpened, setIsAddRemoveTagsDialogOpened](false)}\nuseState{[isGridSettingsDialogOpened, setIsGridSettingsDialogOpened](false)}\nuseRef{gridPageLimit}\nuseRef{isDefaultSetting}\nuseReducer{[ignored, forceUpdate](0)}\nuseFirstRender{firstRender}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseEffect{}\nuseMemo{sortedDirContentMemoized}",(()=>[G.Z]));const U=(0,s.$j)(z,I)((0,a.Z)(g.Z,{withTheme:!0})(H)),X=U;var Y,K;(Y="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(Y.register(Z,"getSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),Y.register(H,"GridPerspective","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),Y.register(I,"mapActionCreatorsToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),Y.register(z,"mapStateToProps","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx"),Y.register(U,"default","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/components/MainContainer.tsx")),(K="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&K(e)},99765:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o.Z,defaultSettings:()=>s});var r,o=n(13899);e=n.hmd(e),(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e),"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;const s={testID:"listPerspectiveContainer",settingsKey:"tsPerspectiveList",orderBy:!0,sortBy:"byName",layoutType:"row",singleClickAction:"openInternal",entrySize:"small",thumbnailMode:"contain",showDirectories:!0,showDetails:!0,showDescription:!1,showEntriesDescription:!0,showTags:!0,gridPageLimit:100};var i,l;(i="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&i.register(s,"defaultSettings","/Users/na/TagSpaces/tsbuilder/mainrepo/app/perspectives/list/index.tsx"),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&l(e)}}]);
//# sourceMappingURL=9055.bundle.js.map